language: python
python:
- 3.6
sudo: required
before_install:
- nvm install 8
- npm install -g @angular/cli
install:
- npm install
- npm install -g webdriver-manager
- webdriver-manager update
- pip install transifex-client
before_script:
- sh -e /etc/init.d/xvfb start
script:
- tx push --source
- tx pull --mode sourceastranslation -l he,en
- ng lint
- ng test --no-watch
- ng build --prod --configuration=production
- docker build . -t $DOCKER_REPO:latest
deploy:
  provider: script
  script: bash docker_push
  on:
    branch: master
env:
  global:
  - DBUS_SESSION_BUS_ADDRESS=/dev/null
  - DISPLAY=:99.0
  - CHROME_BIN=chromium-browser
  - DOCKER_REPO: akariv/dgp-ui
  - secure: bN3yG8OA11HNLbTXjHPMEL13v+o9J8oN6jxdSALREjgTyZi3BH0erhR7IL0HTzs1UZzNPWt/6XjmOF7/LYRpiZwoDX5UnyhieZdzcrQu5pEEqNOxjqQUDYR0u7cdQ/y/nuNt6eajeOCMRYX6XbBy6FXWFS4i49gM4BrtTE6eLPDOwnv3hKPeUaxjK7hHjaqhuCSXK0q79co/ZyWB0N6pzcX42oJW1rW+dpb9D75J/2PkeG5nj84MakFHFvS+/2lUt3EO3pZ8VqeEesbNRYpMeAy6+Xi08uMl0PvqXew6cfR3tijJOnCHh2Ju2JRMY8Izcn9fs3F6lU+V5MtDV4SgsFYQcy9+Xtgd+ufmjqfhyXs1mSWP8P3pONqA5Mm2yMz3SKV4t4cefmHSrAZ4n+jxKe26cq06XJuG9H8qG9rqFc+pTf/RGkekbDadtJLSDz2fWeQwxbhGUVKpcksT96mBdKFVkeSeHw1bkv7DS9mZTJGUb47eFlxOgXJ55Er1SrUikNEYYI6q3XHpC8y90nad8txkOp31MQfR02PiPpsgcfLLpDq7lJdsiWJ8UHPk/asjdshmae5c4QHpdkf7kApSdM2IxpNcihbZwoX0KjizhUQXIxjQZ1qsCDE9ejHt+mlN3mknafh5hBBfEADKQ5m+d7pE4GDZPJjX59h8N+HM3Uk=
  - secure: VfUeVVba9eVGATTyn3s5HHxNM740IEPMiEo72+6kQGC2+vgc57Ok56wGHyxzMAigLA+uC7WlCN4bwysslffJszPKYajpPNRrBHh/EKDKK9CbJolawab6zwKBQiWzVtuhcNV6L3J9PvlfTtwctMjgZlQmahb+e29LBKsVQecGlZl4Hen0c5nvfHY9ZzmApi4Po7aZFjE0bPoYKnXA+xOW3goUNnfZtuXpJQzolaDLzw+7F3udEdTcClb186JF7ANkjlJ53W750OtXWE29l+EIyCWnHAWYAkgJefXyj7JH1BjmP+jrfvOXjxuYetIl0YXXTWmbQNgJDschr4wXuJZxHtfNIMLt8+qpKywzmVgyuCN73+46S0/LsJc/ICAcuaCcTn6SJYxjytR9IaExk+riDjINdp1w6nXnDoGaJGlhVJMyVChl7yoLpHUaNYTxVXwWNzzPqE7J+ZLfT7G3lywZywITtX8ogYtGoQBDnsSGT2A+uSLUhn+XE8PBSUEC5YCrWeGcm4tcO5vXebfdZdas+Tzen42+GEiWonSTfxJd55diDIGqkb8gRyUVw7+7vosNTNcnCJO0SMl/HZKYvdwhIjq4TLoesJreR19ub5KbPW/3qpEpxsJH/G0/5Il0lfF7Ac7bYTBcQ0UwfojeT3v2JAzBXN631GsRhubaSHUN7O0=
  - secure: NBK1hgacTugmX7xPP/KMBWc/FfiUih+97bTKtcrcK/0hczH61ngPkwRY7pPkpbTb17PSTbgwXI3DsZlDfT9holdtI7UoC/tAJyyndHl88urtYIyARV7JCKdg7R69gK5qgLOgJKwCIn81TVEYzor4WyGOcrclNvvkha5B0yTPhdj730ArspamEf4dJvNZk4k8MYWU2XJp0LmBns2auKiG3OPAt0Qvc5EpVCxmxGA+Cb8Q0+HQ75QOwZPw5vkYGQ+7e689cebsjgYPJwLkJgQ+8oGFFuQjGvsD1+MD2FkKgdjvyrvUduuMZ/dP9mZkYGfkx92jENYKvAOXgflaivue5Y1aQLUMrWfXatcRJFThgl6UIvcPtsdA8SjR/n/bXWydipeTEAhluwx2ldGvFig/AfLAAKhRGfqv9BRq8LdZIWYlafgGrYFFOrj8GfjQpbw/3t3g3bPA649MwTxoh4cVMF9JaYbeCPBsyD7beHI7NDhWT6dqGX8ATqVfwF6TDQooeDqv4wXC3K/TWztAiSa/AMjpbr+r7wdc9lmrnOd1gXgvTx/KbDCgVTC78h7QEtbk2s5b89uNRmGLSTHN0/OX+1NfpsI5zYe+NPtwJnwf69QFOW86wqqWF/yfLAUCSnN+JLMXoz2INwOlmvCB2y6cPc3/MQ5T8/K38H05iboW7Lw=
